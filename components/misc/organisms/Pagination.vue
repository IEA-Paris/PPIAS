<template>
  <div class="mt-2">
    <!-- Left side -->
    <v-btn
      min-width="35"
      height="35"
      width="35"
      class="mr-2"
      :disabled="value === 1"
      @click="handleClick(value - 1)"
    >
      <v-icon>mdi-chevron-left</v-icon>
    </v-btn>

    <!-- Numbers -->
    <template v-if="length <= totalVisible">
      <v-btn
        v-for="index in length"
        :key="index"
        v-bind="getButtonNumberProps(index)"
        @click="handleClick(index)"
      >
        {{ index }}
      </v-btn>
    </template>
    <template v-else>
      <v-btn
        v-for="index in 2"
        :key="index"
        v-bind="getButtonNumberProps(index)"
        @click="handleClick(index)"
      >
        {{ index }}
      </v-btn>
      <!--  process if current index is between 2 and length - 2 -->
      <template v-if="value > 2 && value < length - 2">
        <span class="mr-2">...</span>
        <v-btn v-bind="getButtonNumberProps(value)">
          {{ value }}
        </v-btn>
        <span class="mr-2">...</span>
      </template>
      <template v-else><span class="mr-2">...</span></template>
      <v-btn
        v-for="index in [...Array(length + 1).keys()].slice(
          length - 1,
          length + 1
        )"
        :key="index"
        v-bind="getButtonNumberProps(index)"
        @click="handleClick(index)"
      >
        {{ index }}
      </v-btn>
    </template>
    <!-- Right side -->
    <v-btn
      min-width="35"
      height="35"
      width="35"
      :disabled="value === length"
      @click="emit('input', value + 1)"
    >
      <v-icon>mdi-chevron-right</v-icon>
    </v-btn>
  </div>
</template>
<script setup>

const props = defineProps({
  totalVisible: {
    type: Number,
    default: 5,
    required: false,
  },
  value: {
    type: Number,
    default: 1,
    required: false,
  },
  length: {
    type: Number,
    default: 1,
    required: false,
  },
})

const emit = defineEmits(['input'])

const getButtonNumberProps = (index) => {
  // Return props for button number
  return {
    minWidth: '35',
    height: '35',
    width: '35',
    text: true,
    plain: props.value !== index,
    tile: true,
    outlined: true,
    class: `mr-2 paginate-btn ${props.value === index ? 'selected' : ''}`,
  }
}

const handleClick = (page) => {
  emit('input', page)
}
</script>
<style>
.paginate-btn.selected {
  background-color: black;
  color: white;
}
</style>
